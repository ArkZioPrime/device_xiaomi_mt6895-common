type batterysecret, domain;
type batterysecret_exec, file_type, exec_type, vendor_file_type;

type persist_file, file_type;

type_transition init batterysecret_exec:process batterysecret;

allow init batterysecret_exec:file { read getattr map execute open };
allow init batterysecret:process { transition };
allow batterysecret batterysecret_exec:file { read getattr map execute open entrypoint };
dontaudit init batterysecret:process { noatsecure };
allow init batterysecret:process { siginh rlimitinh };
allow batterysecret sysfs_type:dir { ioctl read getattr lock open watch watch_reads search };
allow batterysecret sysfs_type:file { ioctl read getattr lock map open watch watch_reads };
allow batterysecret sysfs_type:lnk_file { ioctl read getattr lock map open watch watch_reads };
allow batterysecret rootfs:dir { ioctl read getattr lock open watch watch_reads search };
allow batterysecret rootfs:file { ioctl read getattr lock map open watch watch_reads };
allow batterysecret rootfs:lnk_file { ioctl read getattr lock map open watch watch_reads };
allow batterysecret cgroup:dir { ioctl read getattr lock open watch watch_reads search };
allow batterysecret cgroup:file { ioctl read getattr lock map open watch watch_reads };
allow batterysecret cgroup:lnk_file { ioctl read getattr lock map open watch watch_reads };
allow batterysecret self:capability { sys_tty_config };
allow batterysecret self:capability { sys_boot };
allow batterysecret self:netlink_kobject_uevent_socket { read create bind setopt };
allow batterysecret sysfs_wake_lock:file { ioctl read write getattr lock append map open watch watch_reads };
allow batterysecret sysfs_battery_supply:file { ioctl read write getattr lock append map open watch watch_reads };
allow batterysecret sysfs_wake_lock:file { ioctl read write getattr lock append map open watch watch_reads };
allow batterysecret self:capability2 { block_suspend };
allow batterysecret self:cap2_userns { block_suspend };
allow batterysecret system_suspend_server:binder { call transfer };
allow system_suspend_server batterysecret:binder { transfer };
allow batterysecret system_suspend_server:fd { use };
allow batterysecret system_suspend_hwservice:hwservice_manager { find };
allow batterysecret hwservicemanager:binder { call transfer };
allow hwservicemanager batterysecret:binder { call transfer };
allow hwservicemanager batterysecret:dir { search };
allow hwservicemanager batterysecret:file { read map open };
allow hwservicemanager batterysecret:process { getattr };
allow batterysecret hwservicemanager_prop:file { read getattr map open };
allow batterysecret hidl_manager_hwservice:hwservice_manager { find };
allow batterysecret sysfs:file { write };
allow batterysecret sysfs_usb:file { write lock append map open };
allow batterysecret sysfs_battery_supply:dir { ioctl read getattr lock open watch watch_reads search };
allow batterysecret sysfs_usb_supply:dir { ioctl read getattr lock open watch watch_reads search };
allow batterysecret sysfs_usb_supply:file { ioctl read getattr lock map open watch watch_reads };
allow batterysecret sysfs_usb_supply:lnk_file { ioctl read getattr lock map open watch watch_reads };
allow batterysecret sysfs_batteryinfo:file { ioctl read getattr lock map open watch watch_reads };
allow batterysecret sysfs_type:dir { ioctl read getattr lock open watch watch_reads search };
allow batterysecret sysfs_type:file { ioctl read getattr lock map open watch watch_reads };
allow batterysecret sysfs_type:lnk_file { ioctl read getattr lock map open watch watch_reads };
allow batterysecret init:unix_stream_socket { connectto };
allow batterysecret property_socket:sock_file { write };
allow batterysecret kmsg_device:chr_file { read write open };
allow batterysecret self:capability { chown fsetid };
allow batterysecret rootfs:dir { write };
allow batterysecret persist_file:dir { search };
allow batterysecret mnt_vendor_file:dir { ioctl read write getattr lock open watch watch_reads add_name remove_name search };
allow batterysecret sysfs_usbpd_device:file { write };
allow batterysecret sysfs_usbpd_device:file { read write open };
allow batterysecret sysfs_usb_supply:file { write };
allow batterysecret self:netlink_kobject_uevent_socket { read create bind getopt setopt };
